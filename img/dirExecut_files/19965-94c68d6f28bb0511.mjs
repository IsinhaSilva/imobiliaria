(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[19965,39395],{850115:e=>{e.exports="https://s.pinimg.com/webapp/goodIdea-b770896d.svg"},379507:e=>{e.exports="https://s.pinimg.com/webapp/haha-e2800d2d.svg"},637956:e=>{e.exports="https://s.pinimg.com/webapp/love-c31e0b8d.svg"},909745:e=>{e.exports="https://s.pinimg.com/webapp/thanks-62775475.svg"},128206:e=>{e.exports="https://s.pinimg.com/webapp/wow-3cb697ef.svg"},418601:(e,s,l)=>{var i=l(14841),a=1/0;e.exports=function(e){return e?(e=i(e))===a||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},640554:(e,s,l)=>{var i=l(418601);e.exports=function(e){var s=i(e),l=s%1;return s==s?l?s-l:s:0}},18857:(e,s,l)=>{l.d(s,{G7:()=>h,ZP:()=>p,_E:()=>u,l6:()=>f,rh:()=>d});var i=l(27255),a=l(605028),t=l(66699),o=l(349700),r=l(623568),n=l(883119),c=l(785893);const _=e=>e.checkExperiment("px_show_protected_pin_stats_on_closeup").anyEnabled;function d(e,s,l,t){var o,n,c;if(!s.isAuth)return!1;const d=(0,r.Nc)(e)||(0,r.o)(e),p=(null===(o=e.board)||void 0===o?void 0:o.privacy)===i.Z.BoardPrivacy.PUBLIC,u=(null===(n=e.board)||void 0===n?void 0:n.privacy)===i.Z.BoardPrivacy.PROTECTED,h=(_(l)&&u||p)&&!e.is_repin&&[s.id,t].includes(null===(c=e.pinner)||void 0===c?void 0:c.id),{isStoryPin:f}=(0,a.Z)(e);return d&&(!u||_(l))||s.isPartner&&h||(e=>e.checkExperiment("web_ps4p").anyEnabled)(l)&&f&&h||(0,r.pU)(e)}function p({isVideo:e,isStoryPin:s,i18n:l,showPublicPinStats:i,showPrivateFullScreenPinStats:a}){return e?[{align:"start",displayText:l._('Video views', 'pinRep.pinStats.videoViews', 'Label for views of a video pin on pinrep'),field:"video_views",iconType:"play"},{align:"center",displayText:l._('Avg. time', 'pinRep.pinStats.videoAverageTime', 'Label for average time of a video pin on pinrep'),field:"video_average_time",iconType:"clock",valueFormat:"TIME"},{align:"end",displayText:l._('Saves', 'pinRep.pinStats.save', 'Label for saves of a video pin on pinrep'),field:"save",iconType:"angled-pin"}]:s?i?[{align:"start",displayText:l._('Full screen plays', 'pinRep.pinStats.fullScreenPlays', 'Label for how many times the Idea Pin has been played full screen'),field:"full_screen_play",iconType:"play"}]:a?[{align:"start",displayText:l._('Full screen plays', 'pinRep.pinStats.fullScreenPlays', 'Label for how many times the Idea Pin has been played full screen'),field:"full_screen_play",iconType:"play"},{align:"center",displayText:l._('Impressions', 'pinRep.pinStats.impression', 'Label for impressions of a pin on pinrep'),field:"impression",iconType:"eye"},{align:"end",displayText:l._('Saves', 'pinRep.pinStats.save', 'Label for saves of a pin on pinrep'),field:"save",iconType:"angled-pin"}]:[{align:"start",displayText:l._('Impressions', 'pinRep.pinStats.impression', 'Label for impressions of a pin on pinrep'),field:"impression",iconType:"eye"},{align:"center",displayText:l._('Closeups', 'pinRep.pinStats.closeups', 'Label for closeups of a pin on pinrep'),field:"closeup",iconSize:10,iconType:"hand-pointing"},{align:"end",displayText:l._('Saves', 'pinRep.pinStats.save', 'Label for saves of a pin on pinrep'),field:"save",iconType:"angled-pin"}]:[{align:"start",displayText:l._('Impressions', 'pinRep.pinStats.impression', 'Label for impressions of a pin on pinrep'),field:"impression",iconType:"eye"},{align:"center",displayText:l._('Saves', 'pinRep.pinStats.save', 'Label for saves of a pin on pinrep'),field:"save",iconType:"angled-pin"},{align:"end",displayText:l._('Link clicks', 'pinRep.pinStats.clickthrough', 'Label for click-throughs of a pin on pinrep'),field:"clickthrough",iconSize:10,iconType:"arrow-up-right"}]}function u(e,s,l,i){const{isStoryPin:t,isVideo:_}=(0,a.Z)(e),d=(0,r.Nc)(e),p=(0,r.o)(e)&&(t||!d)?e.creator_analytics:e.aggregated_pin_data.creator_analytics,u=new Date(e.created_at),h=(new Date).getTime()-u.getTime(),f=Math.floor(h/36e5),m=p?p["24h_realtime"].is_realtime:null,y=p?p["24h_realtime"].timestamp:null;let A=null;p&&(A=t||_?p.all_time_realtime.timestamp:p["30d_realtime"].timestamp);const b=A!==y,v=e=>(0,o.nk)(l._('Updated {{ lastUpdated }}', 'closeup.partnerModule.lastUpdated', 'Indicates to the user when the stats were last updated'),{lastUpdated:e}).join(""),P={timeframe:"",lastUpdated:""};if(p)if(m){const e=p["24h_realtime"].impression>=(t||_?p.all_time_realtime.impression:p["30d_realtime"].impression);P.timeframe=e?l._('Last 24 hours', 'closeup.partnerModule.lastUpdatedRealtime', 'Stats from the stated duration'):t||_?l._('Lifetime of pin', 'closeup.partnerModule.lastUpdatedAllTime', 'Stats from stated duration'):l._('Last 30 days', 'closeup.partnerModule.lastUpdated30Days', 'Stats from stated duration'),P.lastUpdated=l._('Real-time estimates', 'closeup.partnerModule.lastUpdatedRealtime', 'Indicates to user that the stats are being updated in real-time')}else if(b||f>48)if(t||_){const e=i(p.all_time_realtime.timestamp);P.timeframe=l._('Lifetime of pin', 'closeup.partnerModule.lastUpdatedAllTime', 'Stats from stated duration'),P.lastUpdated=v(e)}else{const e=i(p["30d_realtime"].timestamp);P.timeframe=l._('Last 30 days', 'closeup.partnerModule.lastUpdated30Days', 'Stats from stated duration'),P.lastUpdated=v(e)}else{const e=i(p["24h_realtime"].timestamp);P.timeframe=l._('Last 24 hours', 'closeup.partnerModule.lastUpdatedHoursAgo', 'Stats from the stated duration'),P.lastUpdated=v(e)}else P.lastUpdated=l._('Stats are currently unavailable', 'closeup.partnerModule.statsUnavailable', 'Stats status for the pin');return(0,c.jsxs)(n.xu,{alignItems:t||"lg"!==s?"center":void 0,display:t||"lg"!==s?"flex":void 0,children:[(0,c.jsx)(n.xv,{align:"end",color:"subtle",size:"100",children:P.lastUpdated}),(t||["md","sm"].includes(s))&&!!p&&(0,c.jsx)(n.xv,{color:"subtle",inline:!0,size:"100",children:" ãƒ»"}),(0,c.jsx)(n.xv,{align:"end",color:"subtle",size:"100",children:P.timeframe})]})}function h(e,s){return(0,t.Z)(s.ngettext('Last {{ count }} Day', 'Last {{ count }} Days', e, 'Previous {{ count }} days from current date', 'Previous {{ count }} days from current date'),{count:e})}function f(e,s){return(0,t.Z)(s.ngettext('Last {{ count }} Hour', 'Last {{ count }} Hours', e, 'analytics.utils', 'Previous {{ count }} hours from current time'),{count:e})}},681227:(e,s,l)=>{function i(e){const s=Object.keys(e);if(s.length>0){return s.sort(((s,l)=>e[l]-e[s])).slice(0,3)}return null}function a(e){const s=Object.values(e);if(s.length>0){return s.reduce(((e,s)=>e+s),0)}return 0}function t(e,s){const{videos:l,is_downstream_promotion:i,is_promoted:a,story_pin_data_id:t,board:o}=e;return!(a||i||(!l||!l.id)&&!t||s||null!=o&&o.is_collaborative&&o.collaborated_by_me)}l.d(s,{At:()=>i,J6:()=>t,Ud:()=>a})},869899:(e,s,l)=>{l.r(s),l.d(s,{RoleBasedAccessControlProvider:()=>b,useRoleBasedAccessControlContext:()=>A});var i=l(667294),a=l(389643),t=l(784590),o=l(19121),r=l(773285),n=l(425288),c=l(70061);const _=e=>{const s={};for(const l in e)Object.prototype.hasOwnProperty.call(e,l)&&("object"!=typeof e[l]||null===e[l]||Array.isArray(e[l])?s[(0,c.Z)(l)]=e[l]:s[(0,c.Z)(l)]=_(e[l]));return s},d=(e,s)=>{const l=[];for(const t in e)t!==s&&l.push({id:t,..._(e[t])});const i=l.sort((({user:{businessName:e}},{user:{businessName:s}})=>e.localeCompare(s))),a=new Map;for(const t of i)a.set(t.id,t);return a};var p=l(622096);const u={profiles:new Map,headerVisible:!1,orbacVisibility:!1,activeProfile:void 0,disableProfileChanger:!1},h=(e,s)=>{switch(s.type){case"LOAD_PROFILES":return{...e,profiles:s.payload};case"SET_ACTIVE_PROFILE":return{...e,activeProfile:s.payload};case"TOGGLE_HEADER_VISIBILITY":return{...e,headerVisible:s.payload};case"TOGGLE_ORBAC_VISIBILITY":return{...e,orbacVisibility:s.payload};case"TOGGLE_DISABLE_PROFILE_CHANGER":return{...e,disableProfileChanger:s.payload};default:return e}},f=e=>{const[s,l]=(0,i.useReducer)(h,u),a=(({dispatch:e,isEnabled:s,state:l})=>{const{orbacVisibility:a,disableProfileChanger:t,headerVisible:o}=l;return{changeProfile:(0,i.useCallback)((l=>{s&&e({type:"SET_ACTIVE_PROFILE",payload:l})}),[s,e]),toggleORBACVisibility:(0,i.useCallback)((l=>{s&&e({type:"TOGGLE_ORBAC_VISIBILITY",payload:null!=l?l:!a})}),[s,e,a]),toggleDisableProfileChanger:(0,i.useCallback)((l=>{s&&e({type:"TOGGLE_DISABLE_PROFILE_CHANGER",payload:null!=l?l:!t})}),[s,e,t]),toggleHeaderVisibility:(0,i.useCallback)((l=>{s&&e({type:"TOGGLE_HEADER_VISIBILITY",payload:null!=l?l:!o})}),[s,e,o])}})({dispatch:l,isEnabled:e,state:s}),{activeProfile:t,orbacVisibility:o}=s;(0,i.useEffect)((()=>{const e=(0,p.qn)("orbacActiveProfile",!1);e&&l({type:"SET_ACTIVE_PROFILE",payload:e})}),[]),(0,i.useEffect)((()=>{const e=(0,p.qn)("orbacVisibilty",!1);e&&l({type:"TOGGLE_ORBAC_VISIBILITY",payload:e})}),[]),(0,i.useEffect)((()=>{(0,p.Nh)("orbacVisibility",o)}),[o]),(0,i.useEffect)((()=>{(0,p.Nh)("orbacActiveProfile",t)}),[t]);return{state:s,actions:a,receiveProfiles:(0,i.useCallback)(((e,s)=>{l({type:"LOAD_PROFILES",payload:d(e,s)})}),[l])}};var m=l(785893);const{Provider:y,useMaybeHook:A}=(0,n.Z)("RoleBasedAccessControlContext"),b=({children:e})=>{const{checkExperiment:s}=(0,r.F)(),l=(0,o.Z)(),n=Boolean(l.isAuth&&l.isPartner&&s("web_m10n_business_access_orbac_www").anyEnabled),{state:c,actions:_,receiveProfiles:d}=f(n),{activeProfile:p,headerVisible:u,profiles:h=[]}=c,A=h?Array.from(h.values()):[],b=(0,a.Z)(A),v=!!(l.isAuth&&A.length>0)&&b,P=l.isAuth?l.id:"",g=l.isAuth?l.username:"",{changeProfile:E,toggleORBACVisibility:T,toggleDisableProfileChanger:z,toggleHeaderVisibility:L}=_;(0,i.useEffect)((()=>{n&&("string"!=typeof b?p||E(P):E(b))}),[b,P,n,E,p]),(0,i.useEffect)((()=>{n&&(v&&!u&&L(!0),!v&&u&&L(!1))}),[L,v,n,u,h]);const{data:S}=(0,t.Z)(n?{name:"ApiResource",options:{url:"/vx/business_access/profiles/",disable_auth_failure_redirect:!0}}:null),I=null==S?void 0:S.profiles;let x;l&&l.isAuth&&c.activeProfile===l.id?x={id:l.id,permissions:["OWNER"],user:{username:g,businessName:l.fullName,imgUrl:l.imageSmallUrl}}:p&&c.profiles&&(x=c.profiles.get(p)),(0,i.useEffect)((()=>{I&&d(I,P)}),[d,I,P]);const R=c.profiles?Array.from(c.profiles.values()):[];return(0,m.jsx)(y,{value:{profiles:R,headerVisible:c.headerVisible,activeProfile:x,changeProfile:E,toggleORBACVisibility:T,toggleDisableProfileChanger:z,toggleHeaderVisibility:L},children:e})}},717615:(e,s,l)=>{l.d(s,{Z:()=>t});var i=l(773285),a=l(869899);const t=()=>{const{checkExperiment:e}=(0,i.F)(),s=(0,a.useRoleBasedAccessControlContext)(),{activeProfile:l}=s||{};return e("web_m10n_business_access_orbac_www").anyEnabled&&l||Object.freeze({})}},389643:(e,s,l)=>{l.d(s,{Z:()=>n});var i=l(702664),a=l(19121),t=l(773285),o=l(53987),r=l(276775);const n=e=>{var s;const l=(0,r.TH)(),n=(0,a.Z)(),{anyEnabled:c}=(0,t.F)().checkExperiment("web_m10n_business_access_orbac_www"),_=(0,r.$B)("/:username"),d=null==_||null===(s=_.params)||void 0===s?void 0:s.username,p=(0,r.$B)("/pin/:id"),u=(0,i.useSelector)((e=>{var s,l,i,a;return!(null==p||null===(s=p.params)||void 0===s||!s.id)&&(null==e||null===(l=e.pins)||void 0===l||null===(i=l[p.params.id])||void 0===i||null===(a=i.pinner)||void 0===a?void 0:a.id)}));if((0,o.ej)(l))return!1;if((0,o.RU)(l))return!0;if((0,o.mY)(l))return c;const h=e.concat(n.isAuth?{user:{username:n.username},id:n.id}:{}).find((e=>{const{user:s={},id:l}=e||{},{username:i}=s;return!!(i&&d||u&&l)&&(i===d||u===l)}));return!!h&&h.id}},231947:(e,s,l)=>{l.d(s,{D3:()=>c,DX:()=>r,KY:()=>_,Ms:()=>i,N1:()=>d,_P:()=>o,lJ:()=>t,nl:()=>a,q6:()=>n});const i=(e,s)=>{let l=e&&e.isAuth?e.username:"";return e&&s&&s.user&&s.user.username&&(l=s.user.username),l},a=(e,s)=>Boolean(s&&s.user&&e&&e.isAuth&&s.id!==e.id?s.user.eligibleForStlTool:e&&e.isAuth&&e.eligibleForStlTool),t=(e,s)=>e&&e.isAuth&&s&&s.id&&s.id!==e.id?s.id:"",o=(e,s,l)=>{var i;return l&&l.user&&s&&s.isAuth&&l.id!==s.id?l.user.merchantId:null===(i=e.advertiser)||void 0===i?void 0:i.merchant_id},r=(e,s,l)=>l&&l.user&&e.isAuth&&l.id!==e.id?l.user.scheduledPinCount||0:e.isAuth&&s&&s.scheduled_pin_count||0,n=(e,s,l)=>!!(e&&e.isAuth&&l&&l.id&&l.id!==e.id&&l.id===s),c=(e,s,l)=>!!(n(e,s,l)||e&&e.isAuth&&s===e.id),_=(e,s,l)=>{const i=s&&s.owner&&s.owner.id||"";return c(e,i,l)};function d(e,s,l){const i=s?s.id:"";return c(e,i,l)}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/19965-94c68d6f28bb0511.mjs.map